<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebRTC 点对点通信</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
</head>
<body>
    <div class="app">
        <header>
            <h1 class="app-title">WebRTC聊天应用</h1>
        </header>
        
        <nav class="nav">
            <a href="#home" class="nav-item active" data-page="home"><i class="fas fa-home"></i> <span>主页</span></a>
            <a href="#chat" class="nav-item" data-page="chat"><i class="fas fa-comments"></i> <span>聊天</span></a>
            <a href="#settings" class="nav-item" data-page="settings"><i class="fas fa-cog"></i> <span>设置</span></a>
        </nav>
        
        <div id="home" class="page active">
            <div class="profile">
                <div class="nickname">
                    <span class="label">当前昵称:</span>
                    <span id="currentNickname"></span>
                    <button id="changeNickname"><i class="fas fa-edit"></i> 切换昵称</button>
                </div>
            </div>
            <div class="connection">
                <h2 class="section-title">创建连接</h2>
                <button id="generateCode"><i class="fas fa-qrcode"></i> 生成连接码</button>
                <div class="code-container">
                    <textarea id="connectionCode" readonly></textarea>
                    <button id="copyCode"><i class="fas fa-copy"></i> 复制</button>
                </div>
                
                <div class="connection-helper">
                    <div class="helper-title">使用说明</div>
                    <a href="#" class="connection-helper-link" id="helpSendCode"><i class="fas fa-share-square"></i> 生成连接码，将连接码发送给对方</a>
                    <a href="#" class="connection-helper-link" id="helpRecipient"><i class="fas fa-user-plus"></i> 等待对方连接，接受连接</a>
                    <a href="#" class="connection-helper-link" id="helpCopyPaste"><i class="fas fa-paste"></i> 对方的应答码粘贴到下方</a>
                </div>
                
                <h2 class="section-title">加入聊天</h2>
                <div class="connect-container">
                    <textarea id="peerCode" placeholder="请输入对方的连接码"></textarea>
                    <button id="connect"><i class="fas fa-plug"></i> 连接</button>
                </div>
                <div class="connection-tip">
                    <i class="fas fa-info-circle"></i>
                    <span>输入对方分享的连接码，点击"连接"按钮发起聊天</span>
                </div>
            </div>
        </div>

        <div id="chat" class="page">
            <div class="contacts">
                <div class="contacts-header">
                    <h3>联系人</h3>
                    <button class="close-contacts icon-button" title="关闭">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <ul id="contactList"></ul>
                <div class="empty-state" id="emptyContactList" style="display: none;">
                    <i class="fas fa-user-friends empty-state-icon"></i>
                    <div class="empty-state-title">还没有联系人</div>
                    <div class="empty-state-subtitle">回到主页创建连接或加入聊天</div>
                </div>
            </div>
            <div class="chat-container">
                <div class="chat-header">
                    <button id="contactsToggle" class="contacts-toggle icon-button" title="显示联系人">
                        <i class="fas fa-users"></i>
                    </button>
                    <h3 id="currentContact">选择一个联系人开始聊天</h3>
                    <div class="chat-actions">
                        <button id="refreshChat" title="刷新消息" class="icon-button">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div id="messages" class="messages"></div>
                <div class="empty-state" id="emptyMessages" style="display: none;">
                    <i class="fas fa-comments empty-state-icon"></i>
                    <div class="empty-state-title">暂无消息</div>
                    <div class="empty-state-subtitle">开始发送消息吧</div>
                </div>
                <div class="input-area">
                    <input type="file" id="fileInput" multiple style="display: none">
                    <button id="attachFile" title="添加附件">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <textarea id="messageInput" placeholder="输入消息..."></textarea>
                    <div class="input-area-buttons">
                        <button id="sendMessage" title="发送">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="settings" class="page">
            <h2 class="section-title">应用设置</h2>
            <div class="settings-section">
                <h3>数据管理</h3>
                <p class="settings-description">清理本地存储的所有聊天记录和用户数据</p>
                <button id="clearCache"><i class="fas fa-trash"></i> 清理缓存</button>
            </div>
            <div class="settings-section">
                <h3>关于</h3>
                <p class="settings-description">WebRTC点对点通信应用 - 版本 1.0</p>
                <p class="settings-description">基于Web技术的点对点加密通信，无需服务器存储聊天内容</p>
            </div>
        </div>
    </div>

    <script src="js/db.js"></script>
    <script src="js/webrtc.js"></script>
    <script src="js/app.js"></script>
</body>
</html> 